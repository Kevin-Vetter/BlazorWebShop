@page "/"
@using BlazorWebShop.Components
@using DAL.Model
@inject HttpClient Http
<PageTitle>WebShop</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app.
@if (Products != null)
{
    <div class="container">
        <div class="row g-5">
            @foreach (Product prod in Products.Items)
            {
                <ProductCardComponent CurrentProduct="@prod"></ProductCardComponent>
            }
        </div>

        <nav class="d-flex justify-content-between">

            <ul class="pagination">
                <li class="page-item"><input type="submit"  class="page-link" value="Previous" /></li>
                @for (int i = 1; i <= count; i++)
                {
                    <li class="page-item"><input type="submit"  value="@i" class="page-link" /></li>
                }
                <li class="page-item"><input class="page-link" type="submit" value="Next" /></li>
            </ul>
            <ul class="pagination">
                <li class="page-item">
                    <select asp-for="PageSize" onchange="" class="form-select-sm h-100">
                        <option value="10">10</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </li>
            </ul>
        </nav>
    </div>
}


@code {

    private Page<Product> Products { get; set; }

    private string search { get; set; } = string.Empty;
    private int page { get; set; } = 1;
    private int count { get; set; } = 5;


    protected async override Task OnInitializedAsync()
    {

        Products = await Http.GetFromJsonAsync<Page<Product>>($"https://localhost:7180/api/Products?search={search}&page={page}&count={count}");

        await base.OnInitializedAsync();
    }


}
